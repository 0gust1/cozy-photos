{"version":3,"file":"public/javascripts/app.js","sources":["app/application.coffee","app/collections/album.coffee","app/collections/photo.coffee","app/initialize.coffee","app/lib/base_view.coffee","app/lib/client.coffee","app/lib/clipboard.coffee","app/lib/helpers.coffee","app/lib/view_collection.coffee","app/locales/en.coffee","app/locales/fr.coffee","app/models/album.coffee","app/models/contact.coffee","app/models/photo.coffee","app/models/photoprocessor.coffee","app/models/thumbprocessor.coffee","app/router.coffee","app/templates/album.jade","app/templates/albumlist.jade","app/templates/albumlist_item.jade","app/templates/galery.jade","app/templates/photo.jade","app/views/album.coffee","app/views/albumslist.coffee","app/views/albumslist_item.coffee","app/views/galery.coffee","app/views/photo.coffee"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/BA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlBA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAtBA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA7DA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlCA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzBA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA5CA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnIA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAxGA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAtCA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAtCA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA7DA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AApBA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAtCA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AApMA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzHA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvGA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA5HA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAdA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAVA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAdA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAZA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAtUA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlCA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA7CA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AApOA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA1GA;AAAA","sourcesContent":["module.exports = {\n  initialize: function() {\n    var AlbumCollection, Router, e, locales;\n    this.locale = window.locale;\n    this.polyglot = new Polyglot();\n    try {\n      locales = require('locales/' + this.locale);\n    } catch (_error) {\n      e = _error;\n      locales = require('locales/en');\n    }\n    this.polyglot.extend(locales);\n    window.t = this.polyglot.t.bind(this.polyglot);\n    AlbumCollection = require('collections/album');\n    Router = require('router');\n    this.router = new Router();\n    this.albums = new AlbumCollection();\n    this.mode = window.location.pathname.match(/public/) ? 'public' : 'owner';\n    if (window.initalbums) {\n      this.albums.reset(window.initalbums, {\n        parse: true\n      });\n      delete window.initalbums;\n      return Backbone.history.start();\n    } else {\n      return this.albums.fetch().done(function() {\n        return Backbone.history.start();\n      });\n    }\n  }\n};\n","var AlbumCollection,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nmodule.exports = AlbumCollection = (function(_super) {\n  __extends(AlbumCollection, _super);\n\n  function AlbumCollection() {\n    return AlbumCollection.__super__.constructor.apply(this, arguments);\n  }\n\n  AlbumCollection.prototype.model = require('models/album');\n\n  AlbumCollection.prototype.url = 'albums';\n\n  return AlbumCollection;\n\n})(Backbone.Collection);\n","var PhotoCollection,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nmodule.exports = PhotoCollection = (function(_super) {\n  __extends(PhotoCollection, _super);\n\n  function PhotoCollection() {\n    return PhotoCollection.__super__.constructor.apply(this, arguments);\n  }\n\n  PhotoCollection.prototype.model = require('models/photo');\n\n  PhotoCollection.prototype.url = 'photos';\n\n  PhotoCollection.prototype.comparator = function(model) {\n    return model.get('title');\n  };\n\n  return PhotoCollection;\n\n})(Backbone.Collection);\n","var app;\n\napp = require('application');\n\n$(function() {\n  jQuery.event.props.push('dataTransfer');\n  app.initialize();\n  return $.fn.spin = function(opts, color) {\n    var presets;\n    presets = {\n      tiny: {\n        lines: 8,\n        length: 2,\n        width: 2,\n        radius: 3\n      },\n      small: {\n        lines: 8,\n        length: 1,\n        width: 2,\n        radius: 5\n      },\n      large: {\n        lines: 10,\n        length: 8,\n        width: 4,\n        radius: 8\n      }\n    };\n    if (Spinner) {\n      return this.each(function() {\n        var $this, spinner;\n        $this = $(this);\n        spinner = $this.data(\"spinner\");\n        if (spinner != null) {\n          spinner.stop();\n          return $this.data(\"spinner\", null);\n        } else if (opts !== false) {\n          if (typeof opts === \"string\") {\n            if (opts in presets) {\n              opts = presets[opts];\n            } else {\n              opts = {};\n            }\n            if (color) {\n              opts.color = color;\n            }\n          }\n          spinner = new Spinner($.extend({\n            color: $this.css(\"color\")\n          }, opts));\n          spinner.spin(this);\n          return $this.data(\"spinner\", spinner);\n        }\n      });\n    } else {\n      console.log(\"Spinner class not available.\");\n      return null;\n    }\n  };\n});\n","var BaseView,\n  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nmodule.exports = BaseView = (function(_super) {\n  __extends(BaseView, _super);\n\n  function BaseView() {\n    this.render = __bind(this.render, this);\n    return BaseView.__super__.constructor.apply(this, arguments);\n  }\n\n  BaseView.prototype.initialize = function(options) {\n    return this.options = options;\n  };\n\n  BaseView.prototype.template = function() {};\n\n  BaseView.prototype.getRenderData = function() {};\n\n  BaseView.prototype.render = function() {\n    var data;\n    data = _.extend({}, this.options, this.getRenderData());\n    this.$el.html(this.template(data));\n    this.afterRender();\n    return this;\n  };\n\n  BaseView.prototype.afterRender = function() {};\n\n  return BaseView;\n\n})(Backbone.View);\n","exports.request = function(type, url, data, callbacks) {\n  return $.ajax({\n    type: type,\n    url: url,\n    data: data,\n    success: callbacks.success,\n    error: callbacks.error\n  });\n};\n\nexports.get = function(url, callbacks) {\n  return exports.request(\"GET\", url, null, callbacks);\n};\n\nexports.post = function(url, data, callbacks) {\n  return exports.request(\"POST\", url, data, callbacks);\n};\n\nexports.put = function(url, data, callbacks) {\n  return exports.request(\"PUT\", url, data, callbacks);\n};\n\nexports.del = function(url, callbacks) {\n  return exports.request(\"DELETE\", url, null, callbacks);\n};\n","var Clipboard,\n  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\nmodule.exports = Clipboard = (function() {\n  function Clipboard() {\n    this.set = __bind(this.set, this);\n    this.value = \"\";\n    $(document).keydown((function(_this) {\n      return function(e) {\n        var _ref, _ref1;\n        if (!_this.value || !(e.ctrlKey || e.metaKey)) {\n          return;\n        }\n        if (typeof window.getSelection === \"function\" ? (_ref = window.getSelection()) != null ? _ref.toString() : void 0 : void 0) {\n          return;\n        }\n        if ((_ref1 = document.selection) != null ? _ref1.createRange().text : void 0) {\n          return;\n        }\n        return _.defer(function() {\n          var $clipboardContainer;\n          $clipboardContainer = $(\"#clipboard-container\");\n          $clipboardContainer.empty().show();\n          return $(\"<textarea id='clipboard'></textarea>\").val(_this.value).appendTo($clipboardContainer).focus().select();\n        });\n      };\n    })(this));\n    $(document).keyup((function(_this) {\n      return function(e) {\n        if ($(e.target).is(\"#clipboard\")) {\n          $(\"<textarea id='clipboard'></textarea>\").val(\"\");\n          return $(\"#clipboard-container\").empty().hide();\n        }\n      };\n    })(this));\n  }\n\n  Clipboard.prototype.set = function(value) {\n    return this.value = value;\n  };\n\n  return Clipboard;\n\n})();\n","module.exports = {\n  limitLength: function(string, length) {\n    if ((string != null) && string.length > length) {\n      return string.substring(0, length) + '...';\n    } else {\n      return string;\n    }\n  },\n  editable: function(el, options) {\n    var onChanged, placeholder;\n    placeholder = options.placeholder, onChanged = options.onChanged;\n    el.prop('contenteditable', true);\n    if (!el.text()) {\n      el.text(placeholder);\n    }\n    el.click(function() {\n      if (el.text() === placeholder) {\n        return el.text(' ');\n      }\n    });\n    el.focus(function() {\n      if (el.text() === placeholder) {\n        return el.text(' ');\n      }\n    });\n    return el.blur(function() {\n      if (!el.text()) {\n        return el.text(placeholder);\n      } else {\n        return onChanged(el.html());\n      }\n    });\n  },\n  forceFocus: function(el) {\n    var range, sel;\n    range = document.createRange();\n    range.selectNodeContents(el[0]);\n    sel = document.getSelection();\n    sel.removeAllRanges();\n    sel.addRange(range);\n    return el.focus();\n  },\n  rotate: function(orientation, image) {\n    var transform;\n    if (navigator.userAgent.search(\"Firefox\") !== -1) {\n      transform = \"transform\";\n    } else {\n      transform = \"-webkit-transform\";\n    }\n    if (orientation === void 0 || orientation === 1) {\n      image.css(transform, \"rotate(\" + 0 + \"deg)\");\n    } else if (orientation === 2) {\n      return image.css(transform, \"scale(-1, 1)\");\n    } else if (orientation === 3) {\n      return image.css(transform, \"rotate(\" + 180 + \"deg)\");\n    } else if (orientation === 4) {\n      return image.css(transform, \"scale(1, -1)\");\n    } else if (orientation === 5) {\n      return image.css(transform, \"rotate(\" + -90 + \"deg) scale(-1, 1) \");\n    } else if (orientation === 6) {\n      return image.css(transform, \"rotate(\" + 90 + \"deg)\");\n    } else if (orientation === 7) {\n      return image.css(transform, \"rotate(\" + 90 + \"deg) scale(-1, 1)\");\n    } else if (orientation === 8) {\n      return image.css(transform, \"rotate(\" + -90 + \"deg)\");\n    }\n  },\n  getRotate: function(orientation, image) {\n    var transform;\n    if (navigator.userAgent.search(\"Firefox\") !== -1) {\n      transform = \"transform\";\n    } else {\n      transform = \"-webkit-transform\";\n    }\n    if (orientation === void 0 || orientation === 1) {\n      return transform + \": rotate(\" + 0 + \"deg)\";\n    } else if (orientation === 2) {\n      return transform + \": scale(-1, 1)\";\n    } else if (orientation === 3) {\n      return transform + \": rotate(\" + 180 + \"deg)\";\n    } else if (orientation === 4) {\n      return transform + \": scale(1, -1)\";\n    } else if (orientation === 5) {\n      return transform + \": rotate(\" + -90 + \"deg) scale(-1, 1) \";\n    } else if (orientation === 6) {\n      return transform + \": rotate(\" + 90 + \"deg)\";\n    } else if (orientation === 7) {\n      return transform + \": rotate(\" + 90 + \"deg) scale(-1, 1)\";\n    } else if (orientation === 8) {\n      return transform + \": rotate(\" + -90 + \"deg)\";\n    }\n  },\n  rotateLeft: function(orientation, image) {\n    if (orientation === void 0 || orientation === 1) {\n      return 8;\n    } else if (orientation === 2) {\n      return 5;\n    } else if (orientation === 3) {\n      return 6;\n    } else if (orientation === 4) {\n      return 7;\n    } else if (orientation === 5) {\n      return 4;\n    } else if (orientation === 6) {\n      return 1;\n    } else if (orientation === 7) {\n      return 2;\n    } else if (orientation === 8) {\n      return 3;\n    }\n  },\n  rotateRight: function(orientation, image) {\n    if (orientation === void 0 || orientation === 1) {\n      return 6;\n    } else if (orientation === 2) {\n      return 7;\n    } else if (orientation === 3) {\n      return 8;\n    } else if (orientation === 4) {\n      return 5;\n    } else if (orientation === 5) {\n      return 2;\n    } else if (orientation === 6) {\n      return 3;\n    } else if (orientation === 7) {\n      return 4;\n    } else if (orientation === 8) {\n      return 1;\n    }\n  }\n};\n","var BaseView, ViewCollection,\n  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nBaseView = require('lib/base_view');\n\nmodule.exports = ViewCollection = (function(_super) {\n  __extends(ViewCollection, _super);\n\n  function ViewCollection() {\n    this.removeItem = __bind(this.removeItem, this);\n    this.addItem = __bind(this.addItem, this);\n    return ViewCollection.__super__.constructor.apply(this, arguments);\n  }\n\n  ViewCollection.prototype.views = {};\n\n  ViewCollection.prototype.itemView = null;\n\n  ViewCollection.prototype.itemViewOptions = function() {};\n\n  ViewCollection.prototype.checkIfEmpty = function() {\n    return this.$el.toggleClass('empty', _.size(this.views) === 0);\n  };\n\n  ViewCollection.prototype.appendView = function(view) {\n    var className, index, selector, tagName;\n    index = this.collection.indexOf(view.model);\n    if (index === 0) {\n      return this.$el.append(view.$el);\n    } else {\n      className = view.className != null ? \".\" + view.className : \"\";\n      tagName = view.tagName || \"\";\n      selector = \"\" + tagName + className + \":nth-of-type(\" + index + \")\";\n      return this.$el.find(selector).after(view.$el);\n    }\n  };\n\n  ViewCollection.prototype.initialize = function() {\n    ViewCollection.__super__.initialize.apply(this, arguments);\n    this.views = {};\n    this.listenTo(this.collection, \"reset\", this.onReset);\n    this.listenTo(this.collection, \"add\", this.addItem);\n    this.listenTo(this.collection, \"sort\", this.render);\n    this.listenTo(this.collection, \"remove\", this.removeItem);\n    return this.onReset(this.collection);\n  };\n\n  ViewCollection.prototype.render = function() {\n    var id, view, _ref;\n    _ref = this.views;\n    for (id in _ref) {\n      view = _ref[id];\n      view.$el.detach();\n    }\n    return ViewCollection.__super__.render.apply(this, arguments);\n  };\n\n  ViewCollection.prototype.afterRender = function() {\n    var i, _i, _ref;\n    if (this.collection.length > 0) {\n      for (i = _i = 0, _ref = this.collection.length - 1; 0 <= _ref ? _i <= _ref : _i >= _ref; i = 0 <= _ref ? ++_i : --_i) {\n        this.appendView(this.views[this.collection.at(i).cid]);\n      }\n      return this.checkIfEmpty(this.views);\n    }\n  };\n\n  ViewCollection.prototype.remove = function() {\n    this.onReset([]);\n    return ViewCollection.__super__.remove.apply(this, arguments);\n  };\n\n  ViewCollection.prototype.onReset = function(newcollection) {\n    var id, view, _ref;\n    _ref = this.views;\n    for (id in _ref) {\n      view = _ref[id];\n      view.remove();\n    }\n    return newcollection.forEach(this.addItem);\n  };\n\n  ViewCollection.prototype.addItem = function(model) {\n    var options, view;\n    options = _.extend({}, {\n      model: model\n    }, this.itemViewOptions(model));\n    view = new this.itemView(options);\n    this.views[model.cid] = view.render();\n    this.appendView(view);\n    return this.checkIfEmpty(this.views);\n  };\n\n  ViewCollection.prototype.removeItem = function(model) {\n    this.views[model.cid].remove();\n    delete this.views[model.cid];\n    return this.checkIfEmpty(this.views);\n  };\n\n  return ViewCollection;\n\n})(BaseView);\n","module.exports = {\n  \"Back\": \"Back\",\n  \"Create a new album\": \"Create a new album\",\n  \"Delete\": \"Delete\",\n  \"Download\": \"Download\",\n  \"Edit\": \"Edit\",\n  \"It will appears on your homepage.\": \"It will appears on your homepage.\",\n  \"Make it Hidden\": \"hidden\",\n  \"Make it Private\": \"private\",\n  \"Make it Public\": \"public\",\n  \"New\": \"New\",\n  \"private\": \"private\",\n  \"public\": \"public\",\n  \"hidden\": \"hidden\",\n  \"There is no photos in this album\": \"There are no photos in this album\",\n  \"There is no public albums.\": \"There are no albums.\",\n  \"This album is private\": \"This album is private\",\n  \"This album is hidden\": \"This album is hidden\",\n  \"This album is public\": \"This album is public\",\n  \"Title ...\": \"Title ...\",\n  \"View\": \"View\",\n  \"Write some more ...\": \"Write some more ...\",\n  \"is too big (max 10Mo)\": \"is too big (max 10Mo)\",\n  \"is not an image\": \"is not an image\",\n  \"Share album by mail\": \"Share album by mail\",\n  \"Upload your contacts ...\": \"Upload your contacts ...\",\n  \"Share album\": \"Share album\",\n  \"Add contact\": \"Add contact\",\n  \"Send mail\": \"Send mail\",\n  \"Select your friends\": \"Select your friends\",\n  \"Add\": \"Add\",\n  \"Cancel\": \"Cancel\",\n  'photo successfully set as cover': 'The picture has been successfully set as album cover',\n  'problem occured while setting cover': 'A problem occured while setting picture as cover',\n  \"Click Here or drag your photos below to upload\": \"Click Here or drag your photos below to upload\",\n  \"hidden-description\": \"It will not appears on your homepage.\\nBut you can share it with the following url :\",\n  \"It cannot be accessed from the public side\": \"It cannot be accessed from the public side\\\"\"\n};\n","module.exports = {\n  \"Back\": \"Retour\",\n  \"Create a new album\": \"Créer un nouvel album\",\n  \"Delete\": \"Supprimer\",\n  \"Download\": \"Télécharger\",\n  \"Edit\": \"Modifier\",\n  \"It will appears on your homepage.\": \"It apparaitra votre page d'accueil\",\n  \"Make it Hidden\": \"masqué\",\n  \"Make it Private\": \"privé\",\n  \"Make it Public\": \"public\",\n  \"New\": \"Nouveau\",\n  \"private\": \"privé\",\n  \"public\": \"public\",\n  \"hidden\": \"masqué\",\n  \"There is no photos in this album\": \"Pas de photos dans cet album\",\n  \"There is no public albums.\": \"Il n'y a aucun album\",\n  \"This album is private\": \"Cet album est Privé\",\n  \"This album is hidden\": \"Cet album est Masqué\",\n  \"This album is public\": \"Cet album est Public\",\n  \"Title ...\": \"Titre ...\",\n  \"Write some more ...\": \"Description ...\",\n  \"View\": \"Voir\",\n  \"is too big (max 10Mo)\": \"est trop grosse (max 10Mo)\",\n  \"is not an image\": \"n'est pas une image\",\n  \"Share album by mail\": \"Partagez par mail\",\n  \"Upload your contacts ...\": \"Uploader vos contacts ...\",\n  \"Share album\": \"Partagez l'album\",\n  \"Add contact\": \"Ajouter contact\",\n  \"Send mail\": \"Envoyez mail\",\n  \"Select your friends\": \"Choisissez vos amis\",\n  \"Add\": \"Ajouter\",\n  \"Cancel\": \"Annuler\",\n  'photo successfully set as cover': 'L\\'image est maintenant la couverture de l\\'album.',\n  'problem occured while setting cover': 'Un problème est survenu en positionnant l\\'image comme couverture de\\nl\\'album.',\n  \"Click Here or drag your photos below to upload\": \"Cliquez ici pour ajouter des photos ou déposer vos fichiers\",\n  \"hidden-description\": \"Il n'apparaitra pas sur votre page d'accueil,\\nMais vous pouvez partager cet url :\",\n  \"It cannot be accessed from the public side\": \"Il ne peut pas être vu depuis le coté public\"\n};\n","var Album, PhotoCollection, client,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nPhotoCollection = require('collections/photo');\n\nclient = require(\"../lib/client\");\n\nmodule.exports = Album = (function(_super) {\n  __extends(Album, _super);\n\n  Album.prototype.urlRoot = 'albums';\n\n  Album.prototype.defaults = function() {\n    return {\n      title: '',\n      description: '',\n      clearance: 'private',\n      thumbsrc: 'img/nophotos.gif',\n      orientation: 1\n    };\n  };\n\n  function Album() {\n    this.photos = new PhotoCollection();\n    return Album.__super__.constructor.apply(this, arguments);\n  }\n\n  Album.prototype.parse = function(attrs) {\n    var _ref, _ref1, _ref2;\n    if (((_ref = attrs.photos) != null ? _ref.length : void 0) > 0) {\n      this.photos.reset(attrs.photos, {\n        parse: true\n      });\n    }\n    delete attrs.photos;\n    if (attrs.coverPicture) {\n      attrs.thumbsrc = \"photos/thumbs/\" + attrs.coverPicture + \".jpg\";\n      if (((_ref1 = this.photos.get(attrs.thumb)) != null ? (_ref2 = _ref1.attributes) != null ? _ref2.orientation : void 0 : void 0) != null) {\n        attrs.orientation = this.photos._byId[attrs.thumb].attributes.orientation;\n      }\n    }\n    return attrs;\n  };\n\n  Album.prototype.getThumbSrc = function() {\n    return \"photos/thumbs/\" + (this.get('coverPicture')) + \".jpg\";\n  };\n\n  Album.prototype.sendMail = function(url, mails, callback) {\n    var data;\n    data = {\n      url: url,\n      mails: mails\n    };\n    return client.post(\"albums/share\", data, callback);\n  };\n\n  return Album;\n\n})(Backbone.Model);\n","var Contact, client,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nclient = require(\"../lib/client\");\n\nmodule.exports = Contact = (function(_super) {\n  __extends(Contact, _super);\n\n  function Contact() {\n    return Contact.__super__.constructor.apply(this, arguments);\n  }\n\n  Contact.prototype.list = function(callback) {\n    return client.get(\"contacts\", callback);\n  };\n\n  return Contact;\n\n})(Backbone.Model);\n","var Photo,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nmodule.exports = Photo = (function(_super) {\n  __extends(Photo, _super);\n\n  function Photo() {\n    return Photo.__super__.constructor.apply(this, arguments);\n  }\n\n  Photo.prototype.defaults = function() {\n    return {\n      thumbsrc: 'img/loading.gif',\n      src: '',\n      orientation: 1\n    };\n  };\n\n  Photo.prototype.parse = function(attrs) {\n    if (!attrs.id) {\n      return attrs;\n    } else {\n      return _.extend(attrs, {\n        thumbsrc: \"photos/thumbs/\" + attrs.id + \".jpg\",\n        src: \"photos/\" + attrs.id + \".jpg\",\n        orientation: attrs.orientation\n      });\n    }\n  };\n\n  Photo.prototype.getPrevSrc = function() {\n    return \"photos/\" + (this.get('id')) + \".jpg\";\n  };\n\n  return Photo;\n\n})(Backbone.Model);\n","var PhotoProcessor, blobify, makeScreenBlob, makeScreenDataURI, makeThumbBlob, makeThumbDataURI, makeThumbWorker, readFile, resize, upload, uploadWorker;\n\nreadFile = function(photo, next) {\n  var reader;\n  if (photo.file.size > 10 * 1024 * 1024) {\n    return next(t('is too big (max 10Mo)'));\n  }\n  if (!photo.file.type.match(/image\\/.*/)) {\n    return next(t('is not an image'));\n  }\n  reader = new FileReader();\n  photo.img = new Image();\n  reader.readAsDataURL(photo.file);\n  return reader.onloadend = (function(_this) {\n    return function() {\n      photo.img.src = reader.result;\n      photo.img.orientation = photo.attributes.orientation;\n      return photo.img.onload = function() {\n        return next();\n      };\n    };\n  })(this);\n};\n\nresize = function(photo, MAX_WIDTH, MAX_HEIGHT, fill) {\n  var canvas, ctx, max, newdims, ratio, ratiodim;\n  max = {\n    width: MAX_WIDTH,\n    height: MAX_HEIGHT\n  };\n  if ((photo.img.width > photo.img.height) === fill) {\n    ratiodim = 'height';\n  } else {\n    ratiodim = 'width';\n  }\n  ratio = max[ratiodim] / photo.img[ratiodim];\n  newdims = {\n    height: ratio * photo.img.height,\n    width: ratio * photo.img.width\n  };\n  canvas = document.createElement('canvas');\n  canvas.width = fill ? MAX_WIDTH : newdims.width;\n  canvas.height = fill ? MAX_HEIGHT : newdims.height;\n  ctx = canvas.getContext('2d');\n  ctx.drawImage(photo.img, 0, 0, newdims.width, newdims.height);\n  return canvas.toDataURL(photo.file.type);\n};\n\nblobify = function(dataUrl, type) {\n  var array, binary, i, _i, _ref;\n  binary = atob(dataUrl.split(',')[1]);\n  array = [];\n  for (i = _i = 0, _ref = binary.length; 0 <= _ref ? _i <= _ref : _i >= _ref; i = 0 <= _ref ? ++_i : --_i) {\n    array.push(binary.charCodeAt(i));\n  }\n  return new Blob([new Uint8Array(array)], {\n    type: type\n  });\n};\n\nmakeThumbDataURI = function(photo, next) {\n  photo.thumb_du = resize(photo, 300, 300, true);\n  return next();\n};\n\nmakeScreenDataURI = function(photo, next) {\n  photo.screen_du = resize(photo, 1200, 800, false);\n  return next();\n};\n\nmakeScreenBlob = function(photo, next) {\n  photo.thumb = blobify(photo.thumb_du, photo.file.type);\n  return next();\n};\n\nmakeThumbBlob = function(photo, next) {\n  photo.screen = blobify(photo.screen_du, photo.file.type);\n  return next();\n};\n\nupload = function(photo, next) {\n  var attr, formdata, _i, _len, _ref;\n  formdata = new FormData();\n  _ref = ['title', 'description', 'albumid', 'orientation'];\n  for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n    attr = _ref[_i];\n    formdata.append(attr, photo.get(attr));\n  }\n  formdata.append('raw', photo.file);\n  formdata.append('thumb', photo.thumb, \"thumb_\" + photo.file.name);\n  formdata.append('screen', photo.screen, \"screen_\" + photo.file.name);\n  return Backbone.sync('create', photo, {\n    contentType: false,\n    data: formdata,\n    success: function(data) {\n      photo.set(photo.parse(data));\n      return next();\n    },\n    error: function() {\n      return next(t(' : upload failled'));\n    },\n    xhr: function() {\n      var progress, xhr;\n      xhr = $.ajaxSettings.xhr();\n      progress = function(e) {\n        return photo.trigger('progress', e);\n      };\n      if (xhr instanceof window.XMLHttpRequest) {\n        xhr.addEventListener('progress', progress, false);\n      }\n      if (xhr.upload) {\n        xhr.upload.addEventListener('progress', progress, false);\n      }\n      return xhr;\n    }\n  });\n};\n\nmakeThumbWorker = function(photo, done) {\n  return async.waterfall([\n    function(cb) {\n      return readFile(photo, cb);\n    }, function(cb) {\n      return makeThumbDataURI(photo, cb);\n    }, function(cb) {\n      delete photo.img;\n      return cb();\n    }\n  ], function(err) {\n    if (err) {\n      photo.trigger('upError', err);\n    } else {\n      photo.trigger('thumbed');\n    }\n    return done(err);\n  });\n};\n\nuploadWorker = function(photo, done) {\n  return async.waterfall([\n    function(cb) {\n      return readFile(photo, cb);\n    }, function(cb) {\n      return makeScreenDataURI(photo, cb);\n    }, function(cb) {\n      return makeScreenBlob(photo, cb);\n    }, function(cb) {\n      return makeThumbBlob(photo, cb);\n    }, function(cb) {\n      return upload(photo, cb);\n    }, function(cb) {\n      delete photo.file;\n      delete photo.img;\n      delete photo.thumb;\n      delete photo.thumb_du;\n      delete photo.scren;\n      delete photo.screen_du;\n      return cb();\n    }\n  ], function(err) {\n    if (err) {\n      photo.trigger('upError', err);\n    } else {\n      photo.trigger('uploadComplete');\n    }\n    return done(err);\n  });\n};\n\nPhotoProcessor = (function() {\n  function PhotoProcessor() {}\n\n  PhotoProcessor.prototype.thumbsQueue = async.queue(makeThumbWorker, 3);\n\n  PhotoProcessor.prototype.uploadQueue = async.queue(uploadWorker, 2);\n\n  PhotoProcessor.prototype.process = function(photo) {\n    return this.thumbsQueue.push(photo, (function(_this) {\n      return function(err) {\n        if (err) {\n          return console.log(err);\n        }\n        return _this.uploadQueue.push(photo, function(err) {\n          if (err) {\n            return console.log(err);\n          }\n        });\n      };\n    })(this));\n  };\n\n  return PhotoProcessor;\n\n})();\n\nmodule.exports = new PhotoProcessor();\n","var ThumbProcessor, blobify, makeThumbBlob, makeThumbDataURI, readFile, resize, upload, uploadWorker;\n\nreadFile = function(photo, next) {\n  photo.img = new Image();\n  photo.img.onload = function() {\n    return next();\n  };\n  return photo.img.src = photo.url;\n};\n\nresize = function(photo, MAX_WIDTH, MAX_HEIGHT, fill) {\n  var canvas, ctx, max, newdims, ratio, ratiodim;\n  max = {\n    width: MAX_WIDTH,\n    height: MAX_HEIGHT\n  };\n  if ((photo.img.width > photo.img.height) === fill) {\n    ratiodim = 'height';\n  } else {\n    ratiodim = 'width';\n  }\n  ratio = max[ratiodim] / photo.img[ratiodim];\n  newdims = {\n    height: ratio * photo.img.height,\n    width: ratio * photo.img.width\n  };\n  canvas = document.createElement('canvas');\n  canvas.width = fill ? MAX_WIDTH : newdims.width;\n  canvas.height = fill ? MAX_HEIGHT : newdims.height;\n  ctx = canvas.getContext('2d');\n  ctx.drawImage(photo.img, 0, 0, newdims.width, newdims.height);\n  return canvas.toDataURL(photo.file.type);\n};\n\nblobify = function(dataUrl, type) {\n  var array, binary, i, _i, _ref;\n  binary = atob(dataUrl.split(',')[1]);\n  array = [];\n  for (i = _i = 0, _ref = binary.length; 0 <= _ref ? _i <= _ref : _i >= _ref; i = 0 <= _ref ? ++_i : --_i) {\n    array.push(binary.charCodeAt(i));\n  }\n  return new Blob([new Uint8Array(array)], {\n    type: type\n  });\n};\n\nmakeThumbDataURI = function(photo, next) {\n  photo.thumb_du = resize(photo, 300, 300, true);\n  return setTimeout(next, 1);\n};\n\nmakeThumbBlob = function(photo, next) {\n  photo.thumb = blobify(photo.thumb_du, photo.file.type);\n  return setTimeout(next, 1);\n};\n\nupload = function(photo, next) {\n  var formdata;\n  formdata = new FormData();\n  formdata.append('thumb', photo.thumb, \"thumb_\" + photo.file.name);\n  return $.ajax({\n    url: \"photos/thumbs/\" + photo.id + \".jpg\",\n    data: formdata,\n    cache: false,\n    contentType: false,\n    processData: false,\n    type: 'PUT',\n    success: function(data) {\n      return $(\"#rebuild-th\").append(\"<p>\" + photo.file.name + \" photo updated.</p>\");\n    }\n  });\n};\n\nuploadWorker = function(photo, done) {\n  return async.waterfall([\n    function(cb) {\n      return readFile(photo, cb);\n    }, function(cb) {\n      return makeThumbDataURI(photo, cb);\n    }, function(cb) {\n      return makeThumbBlob(photo, cb);\n    }, function(cb) {\n      return upload(photo, cb);\n    }, function(cb) {\n      delete photo.img;\n      delete photo.thumb;\n      delete photo.thumb_du;\n      return cb();\n    }\n  ], function(err) {\n    return done(err);\n  });\n};\n\nThumbProcessor = (function() {\n  function ThumbProcessor() {}\n\n  ThumbProcessor.prototype.uploadQueue = async.queue(uploadWorker, 2);\n\n  ThumbProcessor.prototype.process = function(model) {\n    var photo;\n    photo = {\n      url: model.getPrevSrc(),\n      id: model.get('id'),\n      file: {\n        type: 'image/jpeg',\n        name: model.get('title')\n      }\n    };\n    return uploadWorker(photo, function(err) {\n      if (err) {\n        return console.log(err);\n      }\n    });\n  };\n\n  return ThumbProcessor;\n\n})();\n\nmodule.exports = new ThumbProcessor();\n","var Album, AlbumView, AlbumsListView, Router, app,\n  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\napp = require('application');\n\nAlbumsListView = require('views/albumslist');\n\nAlbumView = require('views/album');\n\nAlbum = require('models/album');\n\nmodule.exports = Router = (function(_super) {\n  __extends(Router, _super);\n\n  function Router() {\n    this.displayView = __bind(this.displayView, this);\n    return Router.__super__.constructor.apply(this, arguments);\n  }\n\n  Router.prototype.routes = {\n    '': 'albumslist',\n    'albums': 'albumslist',\n    'albums/edit': 'albumslistedit',\n    'albums/new': 'newalbum',\n    'albums/:albumid': 'album',\n    'albums/:albumid/edit': 'albumedit'\n  };\n\n  Router.prototype.albumslist = function(editable) {\n    if (editable == null) {\n      editable = false;\n    }\n    return this.displayView(new AlbumsListView({\n      collection: app.albums,\n      editable: editable\n    }));\n  };\n\n  Router.prototype.albumslistedit = function() {\n    if (app.mode === 'public') {\n      return this.navigate('albums', true);\n    }\n    return this.albumslist(true);\n  };\n\n  Router.prototype.album = function(id, editable) {\n    var album;\n    if (editable == null) {\n      editable = false;\n    }\n    album = app.albums.get(id) || new Album({\n      id: id\n    });\n    return album.fetch().done((function(_this) {\n      return function() {\n        return _this.displayView(new AlbumView({\n          model: album,\n          editable: editable,\n          contacts: []\n        }));\n      };\n    })(this)).fail((function(_this) {\n      return function() {\n        alert(t('this album does not exist'));\n        return _this.navigate('albums', true);\n      };\n    })(this));\n  };\n\n  Router.prototype.albumedit = function(id) {\n    if (app.mode === 'public') {\n      return this.navigate('albums', true);\n    }\n    return this.album(id, true);\n  };\n\n  Router.prototype.newalbum = function() {\n    if (app.mode === 'public') {\n      return this.navigate('albums', true);\n    }\n    return this.displayView(new AlbumView({\n      model: new Album(),\n      editable: true,\n      contacts: []\n    }));\n  };\n\n  Router.prototype.displayView = function(view) {\n    var el;\n    if (this.mainView) {\n      this.mainView.remove();\n    }\n    this.mainView = view;\n    el = this.mainView.render().$el;\n    el.addClass(\"mode-\" + app.mode);\n    return $('body').append(el);\n  };\n\n  return Router;\n\n})(Backbone.Router);\n","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div class=\"row-fluid\"><div id=\"about\" class=\"span2\"><div id=\"links\" class=\"clearfix\"><p><a href=\"#albums\" class=\"flatbtn back\"><i class=\"icon-arrow-left icon-white\"></i><span>');\nvar __val__ = t(\"Back\")\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</span></a></p>');\nif ( 'undefined' != typeof id)\n{\nbuf.push('<p><a');\nbuf.push(attrs({ 'href':(\"#albums/\" + (id) + \"/edit\"), \"class\": ('flatbtn') + ' ' + ('startediting') }, {\"href\":true}));\nbuf.push('><i class=\"icon-edit icon-white\"></i><span>');\nvar __val__ = t(\"Edit\")\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</span></a><br/></p>');\nif ( photosNumber != 0)\n{\nbuf.push('<p><a');\nbuf.push(attrs({ 'href':(\"albums/\" + (id) + \".zip\"), \"class\": ('flatbtn') + ' ' + ('download') }, {\"href\":true}));\nbuf.push('><i class=\"icon-download-alt icon-white\"></i><span>');\nvar __val__ = t(\"Download\")\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</span></a></p>');\n}\nbuf.push('<p><a');\nbuf.push(attrs({ 'href':(\"#albums/\" + (id) + \"\"), \"class\": ('flatbtn') + ' ' + ('stopediting') }, {\"href\":true}));\nbuf.push('><i class=\"icon-eye-open icon-white\"></i><span>');\nvar __val__ = t(\"View\")\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</span></a></p><p><a class=\"flatbtn delete\"><i class=\"icon-remove icon-white\"></i><span>');\nvar __val__ = t(\"Delete\")\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</span></a></p><p><a href=\"#clearance-modal\" data-toggle=\"modal\" class=\"flatbtn clearance\"><i class=\"icon-upload icon-white\"></i><span>');\nvar __val__ = t(clearance)\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</span></a></p>');\n}\nbuf.push('</div><h1 id=\"title\">');\nvar __val__ = title\nbuf.push(null == __val__ ? \"\" : __val__);\nbuf.push('</h1><div id=\"description\">');\nvar __val__ = description\nbuf.push(null == __val__ ? \"\" : __val__);\nbuf.push('</div></div><div id=\"photos\" class=\"span10\"></div><div id=\"rebuild-th\"><a id=\"rebuild-th-btn\">');\nvar __val__ = t(\"rebuild thumbnails\")\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</a></div><div id=\"clipboard-container\"><textarea id=\"clipboard\"></textarea></div><div id=\"clearance-modal\" class=\"modal hide\"><div class=\"modal-header\"><button type=\"button\" data-dismiss=\"modal\" class=\"close\">&times;</button><h3>clearanceHelpers.title</h3></div><div class=\"modal-body\">clearanceHelpers.content</div><div class=\"modal-footer\">     <a id=\"changeprivate\" class=\"flatbtn changeclearance\">');\nvar __val__ = t(\"Make it Private\")\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</a><a id=\"changehidden\" class=\"flatbtn changeclearance\">');\nvar __val__ = t(\"Make it Hidden\")\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</a><a id=\"changepublic\" class=\"flatbtn changeclearance\">');\nvar __val__ = t(\"Make it Public\")\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</a><a href=\"#share-modal\" data-toggle=\"modal\" data-dismiss=\"modal\" class=\"flatbtn share\"><span>');\nvar __val__ = t(\"Share album by mail\")\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</span></a></div></div><div id=\"share-modal\" class=\"modal hide\"><div class=\"modal-header\"><button type=\"button\" data-dismiss=\"modal\" class=\"close\">&times;</button><h3>');\nvar __val__ = t(\"Share album\")\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</h3></div><div class=\"modal-body\"> <input type=\"text\" value=\"\" id=\"mails\" placeholder=\"example@cozycloud.cc, other-example@cozycloud.cc\" class=\"input-block-level\"/></div><div class=\"modal-footer\"> <a href=\"#add-contact-modal\" data-toggle=\"modal\" data-dismiss=\"modal\" class=\"flatbtn addcontact\"><span>');\nvar __val__ = t(\"Add contact\")\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</span></a><a type=\"button\" data-dismiss=\"modal\" class=\"flatbtn sendmail\"><span>');\nvar __val__ = t(\"Send mail\")    \nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</span></a></div></div><div id=\"add-contact-modal\" class=\"modal hide\"><div class=\"modal-header\"><button type=\"button\" data-dismiss=\"modal\" class=\"close\">&times;</button><h3>');\nvar __val__ = t(\"Select your friends\")\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</h3></div><div class=\"modal-body\"> <div id=\"contacts\" class=\"input\">');\nif ( contacts.length === 0)\n{\nbuf.push('<p>');\nvar __val__ = t(\"Upload your contacts ...\")\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</p>');\n}\nelse if ( contacts === \"No contacts found\")\n{\nbuf.push('<p>');\nvar __val__ = t(\"No contacts found\")\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</p>');\n}\nelse\n{\n// iterate contacts\n;(function(){\n  if ('number' == typeof contacts.length) {\n\n    for (var $index = 0, $$l = contacts.length; $index < $$l; $index++) {\n      var contact = contacts[$index];\n\nbuf.push('<input');\nbuf.push(attrs({ 'type':(\"checkbox\"), 'name':(\"\" + (contact.index) + \"\"), 'id':(\"\" + (contact.index) + \"\"), \"class\": ('checkbox') }, {\"type\":true,\"name\":true,\"id\":true}));\nbuf.push('/><span> ' + escape((interp = contact.fn) == null ? '' : interp) + '</span><br/>');\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in contacts) {\n      $$l++;      var contact = contacts[$index];\n\nbuf.push('<input');\nbuf.push(attrs({ 'type':(\"checkbox\"), 'name':(\"\" + (contact.index) + \"\"), 'id':(\"\" + (contact.index) + \"\"), \"class\": ('checkbox') }, {\"type\":true,\"name\":true,\"id\":true}));\nbuf.push('/><span> ' + escape((interp = contact.fn) == null ? '' : interp) + '</span><br/>');\n    }\n\n  }\n}).call(this);\n\n}\nbuf.push('</div></div><div class=\"modal-footer\">     <a href=\"#share-modal\" data-toggle=\"modal\" data-dismiss=\"modal\" class=\"flatbtn add\"><span>');\nvar __val__ = t(\"Add\")\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</span></a><a href=\"#share-modal\" data-toggle=\"modal\" data-dismiss=\"modal\" class=\"flatbtn cancel\"><span>');\nvar __val__ = t(\"Cancel\")\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</span></a></div></div></div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div class=\"albumitem create\"><a href=\"#albums/new\"><img src=\"img/new-galery.png\"/><br/><span>');\nvar __val__ = t('Create a new album')\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</span></a></div><p class=\"help\">');\nvar __val__ = t('There is no public albums.')\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</p>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<a');\nbuf.push(attrs({ 'id':(\"\" + (id) + \"\"), 'href':(\"#albums/\" + (id) + \"\"), 'style':(\"background-image: url(\" + (thumbsrc) + \")\") }, {\"id\":true,\"href\":true,\"style\":true}));\nbuf.push('><span class=\"title\">' + escape((interp = title) == null ? '' : interp) + '</span></a>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<p class=\"help\">');\nvar __val__ = t('There is no photos in this album')\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</p><div id=\"uploadblock\" class=\"flatbtn photo\"><input id=\"uploader\" type=\"file\" multiple=\"multiple\"/>');\nvar __val__ = t('Click Here or drag your photos below to upload')\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<a');\nbuf.push(attrs({ 'href':(\"\" + (src) + \"\"), 'title':(\"\" + (title) + \"\") }, {\"href\":true,\"title\":true}));\nbuf.push('><img');\nbuf.push(attrs({ 'src':(\"\" + (thumbsrc) + \"\"), 'alt':(\"\" + (title) + \"\") }, {\"src\":true,\"alt\":true}));\nbuf.push('/><div class=\"progressfill\"></div></a><button class=\"delete flatbtn\"><i class=\"icon-remove icon-white\"></i></button>');\n}\nreturn buf.join(\"\");\n};","var AlbumView, BaseView, Clipboard, Contact, Galery, app, clipboard, contactModel, editable, thProcessor,\n  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\napp = require('application');\n\nBaseView = require('lib/base_view');\n\nGalery = require('views/galery');\n\nClipboard = require('lib/clipboard');\n\neditable = require('lib/helpers').editable;\n\nthProcessor = require('models/thumbprocessor');\n\ncontactModel = require('models/contact');\n\nContact = new contactModel();\n\nclipboard = new Clipboard();\n\nmodule.exports = AlbumView = (function(_super) {\n  __extends(AlbumView, _super);\n\n  function AlbumView() {\n    this.makeEditable = __bind(this.makeEditable, this);\n    this.beforePhotoUpload = __bind(this.beforePhotoUpload, this);\n    this.events = __bind(this.events, this);\n    return AlbumView.__super__.constructor.apply(this, arguments);\n  }\n\n  AlbumView.prototype.template = require('templates/album');\n\n  AlbumView.prototype.id = 'album';\n\n  AlbumView.prototype.className = 'container-fluid';\n\n  AlbumView.prototype.events = function() {\n    return {\n      'click a.delete': this.destroyModel,\n      'click a.changeclearance': this.changeClearance,\n      'click a.addcontact': this.addcontact,\n      'click a.sendmail': this.sendMail,\n      'click a.add': this.prepareContact,\n      'click a#rebuild-th-btn': this.rebuildThumbs,\n      'keyup #mails': this.onKeyUpMails\n    };\n  };\n\n  AlbumView.prototype.getRenderData = function() {\n    var clearance, clearanceHelpers, res;\n    clearance = this.model.get('clearance');\n    if (clearance == null) {\n      clearance = 'private';\n    }\n    clearanceHelpers = this.clearanceHelpers(clearance);\n    res = _.extend({\n      clearanceHelpers: clearanceHelpers,\n      photosNumber: this.model.photos.length\n    }, this.model.attributes);\n    return res;\n  };\n\n  AlbumView.prototype.afterRender = function() {\n    this.galery = new Galery({\n      el: this.$('#photos'),\n      editable: this.options.editable,\n      collection: this.model.photos,\n      beforeUpload: this.beforePhotoUpload\n    });\n    this.galery.album = this.model;\n    this.galery.render();\n    if (this.options.editable) {\n      return this.makeEditable();\n    }\n  };\n\n  AlbumView.prototype.beforePhotoUpload = function(callback) {\n    return this.saveModel().then((function(_this) {\n      return function() {\n        return callback({\n          albumid: _this.model.id\n        });\n      };\n    })(this));\n  };\n\n  AlbumView.prototype.makeEditable = function() {\n    this.$el.addClass('editing');\n    this.refreshPopOver(this.model.get('clearance'));\n    editable(this.$('#title'), {\n      placeholder: t('Title ...'),\n      onChanged: (function(_this) {\n        return function(text) {\n          return _this.saveModel({\n            title: text.trim()\n          });\n        };\n      })(this)\n    });\n    return editable(this.$('#description'), {\n      placeholder: t('Write some more ...'),\n      onChanged: (function(_this) {\n        return function(text) {\n          return _this.saveModel({\n            description: text.trim()\n          });\n        };\n      })(this)\n    });\n  };\n\n  AlbumView.prototype.destroyModel = function() {\n    if (this.model.isNew()) {\n      return app.router.navigate('albums', true);\n    }\n    if (confirm(t('Are you sure ?'))) {\n      return this.model.destroy().then(function() {\n        return app.router.navigate('albums', true);\n      });\n    }\n  };\n\n  AlbumView.prototype.changeClearance = function(event) {\n    var id, newclearance;\n    newclearance = event.target.id.replace('change', '');\n    id = event.target.id;\n    this.$(\"#\" + id).spin('tiny');\n    this.$(\"#\" + id).css('color', 'transparent');\n    return this.saveModel({\n      clearance: newclearance\n    }).then((function(_this) {\n      return function() {\n        _this.$(\"#\" + id).spin();\n        _this.$(\"#\" + id).css('color', 'white');\n        return _this.refreshPopOver(newclearance);\n      };\n    })(this));\n  };\n\n  AlbumView.prototype.refreshPopOver = function(clearance) {\n    var help, modal;\n    help = this.clearanceHelpers(clearance);\n    modal = this.$('#clearance-modal');\n    this.$('.clearance').find('span').text(clearance);\n    modal.find('h3').text(help != null ? help.title : void 0);\n    modal.find('.modal-body').html(help != null ? help.content : void 0);\n    modal.find('.changeclearance').removeClass('active');\n    modal.find('#change' + clearance).addClass('active');\n    if (clearance === \"hidden\") {\n      modal.find('.share').show();\n      return clipboard.set(this.getPublicUrl());\n    } else {\n      modal.find('.share').hide();\n      return clipboard.set(\"\");\n    }\n  };\n\n  AlbumView.prototype.addcontact = function() {\n    var modal;\n    modal = this.$('#add-contact-modal');\n    this.options.contacts = [];\n    return Contact.list({\n      success: (function(_this) {\n        return function(body) {\n          var contact, item, n, _i, _j, _len, _len1, _ref;\n          for (_i = 0, _len = body.length; _i < _len; _i++) {\n            contact = body[_i];\n            _ref = contact.datapoints;\n            for (_j = 0, _len1 = _ref.length; _j < _len1; _j++) {\n              item = _ref[_j];\n              if (item.name === \"email\") {\n                contact.index = contact.fn.split(' ').join('_');\n                contact.index = contact.index.split(\"'\").join('_');\n                contact.index = contact.index.split(\"/\").join('_');\n                contact.index = contact.index.split(\"*\").join('_');\n                n = 0;\n                while ((_this.options.contacts[n] != null) && _this.options.contacts[n].fn < contact.fn) {\n                  n++;\n                }\n                _this.options.contacts.splice(n, 0, contact);\n                break;\n              }\n            }\n          }\n          if (_this.options.contacts.length === 0) {\n            _this.options.contacts = \"No contacts found\";\n          }\n          _this.$('#add-contact-modal').modal('hide');\n          _this.render(modal);\n          return _this.$('#add-contact-modal').modal('show');\n        };\n      })(this),\n      error: function(err) {\n        return console.log(err);\n      }\n    });\n  };\n\n  AlbumView.prototype.prepareContact = function(event) {\n    var contact, item, mails, modal, _i, _j, _len, _len1, _ref, _ref1;\n    modal = this.$('#add-contact-modal');\n    mails = [];\n    _ref = this.options.contacts;\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      contact = _ref[_i];\n      if (this.$(\"#\" + contact.index).is(':checked')) {\n        _ref1 = contact.datapoints;\n        for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {\n          item = _ref1[_j];\n          if (item.name === \"email\") {\n            mails.push(' ' + item.value);\n            break;\n          }\n        }\n      }\n    }\n    return this.$('#mails').val(mails);\n  };\n\n  AlbumView.prototype.rebuildThumbs = function(event) {\n    var models, recFunc;\n    $(\"#rebuild-th p\").remove();\n    models = this.model.photos.models;\n    recFunc = function() {\n      var model;\n      if (models.length > -1) {\n        model = models.pop();\n        return setTimeout(function() {\n          thProcessor.process(model);\n          return recFunc();\n        }, 500);\n      }\n    };\n    return recFunc();\n  };\n\n  AlbumView.prototype.onKeyUpMails = function(event) {\n    if (event.which === 13 || event.keyCode === 13) {\n      return this.sendMail();\n    }\n  };\n\n  AlbumView.prototype.sendMail = function(event) {\n    var mails;\n    mails = this.$('#mails').val();\n    if (mails.length === 0) {\n      return alert(\"Please enter an email.\");\n    } else {\n      this.$(\"a.sendmail\").spin('tiny');\n      this.$(\"a.sendmail\").css('color', 'transparent');\n      return this.model.sendMail(this.getPublicUrl(), mails, {\n        success: (function(_this) {\n          return function() {\n            var mail, msg, _i, _len;\n            _this.$(\"a.sendmail\").spin();\n            _this.$(\"a.sendmail\").css('color', 'white');\n            msg = \"Mail was successfully sent to: \\n\";\n            mails = mails.split(',');\n            for (_i = 0, _len = mails.length; _i < _len; _i++) {\n              mail = mails[_i];\n              msg = msg + \"\\n\" + mail;\n            }\n            return alert(msg);\n          };\n        })(this),\n        error: (function(_this) {\n          return function(err) {\n            _this.$(\"a.sendmail\").spin();\n            _this.$(\"a.sendmail\").css('color', 'white');\n            return alert(JSON.parse(err.responseText).error);\n          };\n        })(this)\n      });\n    }\n  };\n\n  AlbumView.prototype.saveModel = function(hash) {\n    var promise;\n    promise = this.model.save(hash);\n    if (this.model.isNew()) {\n      promise = promise.then((function(_this) {\n        return function() {\n          app.albums.add(_this.model);\n          return app.router.navigate(\"albums/\" + _this.model.id + \"/edit\");\n        };\n      })(this));\n    }\n    return promise;\n  };\n\n  AlbumView.prototype.getPublicUrl = function() {\n    var hash, origin, path;\n    origin = window.location.origin;\n    path = window.location.pathname.replace('apps', 'public');\n    if (path === '/') {\n      path = '/public/';\n    }\n    hash = window.location.hash.replace('/edit', '');\n    return origin + path + hash;\n  };\n\n  AlbumView.prototype.clearanceHelpers = function(clearance) {\n    if (clearance === 'public') {\n      return {\n        title: t('This album is public'),\n        content: t('It will appears on your homepage.')\n      };\n    } else if (clearance === 'hidden') {\n      return {\n        title: t('This album is hidden'),\n        content: t(\"hidden-description\") + (\" \" + (this.getPublicUrl())) + \"<p>If you want to copy url in your clipboard: \" + \"just press Ctrl+C </p>\"\n      };\n    } else if (clearance === 'private') {\n      return {\n        title: t('This album is private'),\n        content: t('It cannot be accessed from the public side')\n      };\n    }\n  };\n\n  return AlbumView;\n\n})(BaseView);\n","var AlbumsList, ViewCollection, app,\n  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nViewCollection = require('lib/view_collection');\n\napp = require('application');\n\nmodule.exports = AlbumsList = (function(_super) {\n  __extends(AlbumsList, _super);\n\n  function AlbumsList() {\n    this.checkIfEmpty = __bind(this.checkIfEmpty, this);\n    return AlbumsList.__super__.constructor.apply(this, arguments);\n  }\n\n  AlbumsList.prototype.id = 'album-list';\n\n  AlbumsList.prototype.itemView = require('views/albumslist_item');\n\n  AlbumsList.prototype.template = require('templates/albumlist');\n\n  AlbumsList.prototype.initialize = function() {\n    return AlbumsList.__super__.initialize.apply(this, arguments);\n  };\n\n  AlbumsList.prototype.checkIfEmpty = function() {\n    return this.$('.help').toggle(_.size(this.views) === 0 && app.mode === 'public');\n  };\n\n  return AlbumsList;\n\n})(ViewCollection);\n","var AlbumItem, BaseView, helpers, limitLength,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nBaseView = require('lib/base_view');\n\nlimitLength = require('lib/helpers').limitLength;\n\nhelpers = require('lib/helpers');\n\nmodule.exports = AlbumItem = (function(_super) {\n  __extends(AlbumItem, _super);\n\n  function AlbumItem() {\n    return AlbumItem.__super__.constructor.apply(this, arguments);\n  }\n\n  AlbumItem.prototype.className = 'albumitem';\n\n  AlbumItem.prototype.template = require('templates/albumlist_item');\n\n  AlbumItem.prototype.initialize = function() {\n    return this.listenTo(this.model, 'change', (function(_this) {\n      return function() {\n        return _this.render();\n      };\n    })(this));\n  };\n\n  AlbumItem.prototype.getRenderData = function() {\n    var out;\n    out = _.clone(this.model.attributes);\n    out.description = limitLength(out.description, 250);\n    return out;\n  };\n\n  AlbumItem.prototype.afterRender = function() {\n    this.image = this.$('img');\n    this.image.attr('src', this.model.attributes.thumbsrc);\n    return helpers.rotate(this.model.attributes.orientation, this.image);\n  };\n\n  return AlbumItem;\n\n})(BaseView);\n","var Galery, Photo, PhotoView, ViewCollection, app, helpers, photoprocessor,\n  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nViewCollection = require('lib/view_collection');\n\nhelpers = require('lib/helpers');\n\nPhotoView = require('views/photo');\n\nPhoto = require('models/photo');\n\nphotoprocessor = require('models/photoprocessor');\n\napp = require('application');\n\nmodule.exports = Galery = (function(_super) {\n  __extends(Galery, _super);\n\n  function Galery() {\n    this.onImageDisplayed = __bind(this.onImageDisplayed, this);\n    this.beforeImageDisplayed = __bind(this.beforeImageDisplayed, this);\n    this.onFilesChanged = __bind(this.onFilesChanged, this);\n    this.onCoverClicked = __bind(this.onCoverClicked, this);\n    this.onTurnRight = __bind(this.onTurnRight, this);\n    this.onTurnLeft = __bind(this.onTurnLeft, this);\n    this.getIdPhoto = __bind(this.getIdPhoto, this);\n    this.checkIfEmpty = __bind(this.checkIfEmpty, this);\n    return Galery.__super__.constructor.apply(this, arguments);\n  }\n\n  Galery.prototype.itemView = PhotoView;\n\n  Galery.prototype.template = require('templates/galery');\n\n  Galery.prototype.afterRender = function() {\n    var transform;\n    Galery.__super__.afterRender.apply(this, arguments);\n    this.$el.photobox('a.server', {\n      thumbs: true,\n      history: false,\n      beforeShow: this.beforeImageDisplayed\n    }, this.onImageDisplayed);\n    if ($('#pbOverlay .pbCaptionText .btn-group').length === 0) {\n      $('#pbOverlay .pbCaptionText').append('<div class=\"btn-group\"></div>');\n    }\n    this.turnLeft = $('#pbOverlay .pbCaptionText .btn-group .left');\n    this.turnLeft.unbind('click');\n    this.turnLeft.remove();\n    if (navigator.userAgent.search(\"Firefox\") !== -1) {\n      transform = \"transform\";\n    } else {\n      transform = \"-webkit-transform\";\n    }\n    this.turnLeft = $('<a id=\"left\" class=\"btn left\" type=\"button\"> <i class=\"icon-share-alt\" style=\"' + transform + ': scale(-1,1)\"> </i> </a>').appendTo('#pbOverlay .pbCaptionText .btn-group');\n    this.turnLeft.on('click', this.onTurnLeft);\n    this.downloadLink = $('#pbOverlay .pbCaptionText  .btn-group .download-link');\n    this.downloadLink.unbind('click');\n    this.downloadLink.remove();\n    if (!this.downloadLink.length) {\n      this.downloadLink = $('<a class=\"btn download-link\" download> <i class=\"icon-arrow-down\"></i></a>').appendTo('#pbOverlay .pbCaptionText .btn-group');\n    }\n    this.uploader = this.$('#uploader');\n    this.coverBtn = $('#pbOverlay .pbCaptionText .btn-group .cover-btn');\n    this.coverBtn.unbind('click');\n    this.coverBtn.remove();\n    this.coverBtn = $('<a id=\"cover-btn\" class=\"btn cover-btn\"> <i class=\"icon-picture\" </i> </a>').appendTo('#pbOverlay .pbCaptionText .btn-group');\n    this.coverBtn.on('click', this.onCoverClicked);\n    this.turnRight = $('#pbOverlay .pbCaptionText .btn-group .right');\n    this.turnRight.unbind('click');\n    this.turnRight.remove();\n    this.turnRight = $('<a id=\"right\" class=\"btn right\"> <i class=\"icon-share-alt\" </i> </a>').appendTo('#pbOverlay .pbCaptionText .btn-group');\n    return this.turnRight.on('click', this.onTurnRight);\n  };\n\n  Galery.prototype.checkIfEmpty = function() {\n    return this.$('.help').toggle(_.size(this.views) === 0 && app.mode === 'public');\n  };\n\n  Galery.prototype.events = function() {\n    if (this.options.editable) {\n      return {\n        'drop': 'onFilesDropped',\n        'dragover': 'onDragOver',\n        'change #uploader': 'onFilesChanged'\n      };\n    }\n  };\n\n  Galery.prototype.onFilesDropped = function(evt) {\n    this.$el.removeClass('dragover');\n    this.handleFiles(evt.dataTransfer.files);\n    evt.stopPropagation();\n    evt.preventDefault();\n    return false;\n  };\n\n  Galery.prototype.onDragOver = function(evt) {\n    this.$el.addClass('dragover');\n    evt.preventDefault();\n    evt.stopPropagation();\n    return false;\n  };\n\n  Galery.prototype.getIdPhoto = function(url) {\n    var id, parts;\n    if (url == null) {\n      url = $('#pbOverlay .wrapper img.zoomable').attr('src');\n    }\n    parts = url.split('/');\n    id = parts[parts.length - 1];\n    id = id.split('.')[0];\n    return id;\n  };\n\n  Galery.prototype.onTurnLeft = function() {\n    var id, newOrientation, orientation, _ref, _ref1;\n    id = this.getIdPhoto();\n    orientation = (_ref = this.collection.get(id)) != null ? _ref.attributes.orientation : void 0;\n    newOrientation = helpers.rotateLeft(orientation, $('.wrapper img.zoomable'));\n    helpers.rotate(newOrientation, $('.wrapper img.zoomable'));\n    return (_ref1 = this.collection.get(id)) != null ? _ref1.save({\n      orientation: newOrientation\n    }, {\n      success: (function(_this) {\n        return function() {\n          return helpers.rotate(newOrientation, $('.pbThumbs .active img'));\n        };\n      })(this)\n    }) : void 0;\n  };\n\n  Galery.prototype.onTurnRight = function() {\n    var id, newOrientation, orientation, _ref, _ref1;\n    id = this.getIdPhoto();\n    orientation = (_ref = this.collection.get(id)) != null ? _ref.attributes.orientation : void 0;\n    newOrientation = helpers.rotateRight(orientation, $('.wrapper img.zoomable'));\n    helpers.rotate(newOrientation, $('.wrapper img.zoomable'));\n    return (_ref1 = this.collection.get(id)) != null ? _ref1.save({\n      orientation: newOrientation\n    }, {\n      success: (function(_this) {\n        return function() {\n          return helpers.rotate(newOrientation, $('.pbThumbs .active img'));\n        };\n      })(this)\n    }) : void 0;\n  };\n\n  Galery.prototype.onCoverClicked = function() {\n    var photoId;\n    this.coverBtn.addClass('disabled');\n    photoId = this.getIdPhoto();\n    this.album.set('coverPicture', photoId);\n    this.album.set('thumb', photoId);\n    this.album.set('thumbsrc', this.album.getThumbSrc());\n    return this.album.save(null, {\n      success: (function(_this) {\n        return function() {\n          _this.coverBtn.removeClass('disabled');\n          return alert(t('photo successfully set as cover'));\n        };\n      })(this),\n      error: (function(_this) {\n        return function() {\n          _this.coverBtn.removeClass('disabled');\n          return alert(t('problem occured while setting cover'));\n        };\n      })(this)\n    });\n  };\n\n  Galery.prototype.onFilesChanged = function(evt) {\n    var old;\n    this.handleFiles(this.uploader[0].files);\n    old = this.uploader;\n    this.uploader = old.clone(true);\n    return old.replaceWith(this.uploader);\n  };\n\n  Galery.prototype.beforeImageDisplayed = function(link) {\n    var id, orientation, _ref;\n    id = this.getIdPhoto(link.href);\n    orientation = (_ref = this.collection.get(id)) != null ? _ref.attributes.orientation : void 0;\n    return $('#pbOverlay .wrapper img')[0].dataset.orientation = orientation;\n  };\n\n  Galery.prototype.onImageDisplayed = function(args) {\n    var id, orientation, parts, thumb, thumbs, url, _i, _len, _ref, _results;\n    url = $('.pbThumbs .active img').attr('src');\n    id = this.getIdPhoto();\n    this.downloadLink.attr('href', url.replace('thumbs', 'raws'));\n    thumbs = $('#pbOverlay .pbThumbs img');\n    _results = [];\n    for (_i = 0, _len = thumbs.length; _i < _len; _i++) {\n      thumb = thumbs[_i];\n      url = thumb.src;\n      parts = url.split('/');\n      id = parts[parts.length - 1];\n      id = id.split('.')[0];\n      orientation = (_ref = this.collection.get(id)) != null ? _ref.attributes.orientation : void 0;\n      _results.push(helpers.rotate(orientation, $(thumb)));\n    }\n    return _results;\n  };\n\n  Galery.prototype.handleFiles = function(files) {\n    return this.options.beforeUpload((function(_this) {\n      return function(photoAttributes) {\n        var file, photo, _i, _len, _results;\n        _results = [];\n        for (_i = 0, _len = files.length; _i < _len; _i++) {\n          file = files[_i];\n          photoAttributes.title = file.name;\n          photo = new Photo(photoAttributes);\n          photo.file = file;\n          _this.collection.add(photo);\n          _results.push(photoprocessor.process(photo));\n        }\n        return _results;\n      };\n    })(this));\n  };\n\n  return Galery;\n\n})(ViewCollection);\n","var BaseView, PhotoView, helpers, transitionendEvents,\n  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nBaseView = require('lib/base_view');\n\nhelpers = require('lib/helpers');\n\ntransitionendEvents = [\"transitionend\", \"webkitTransitionEnd\", \"oTransitionEnd\", \"MSTransitionEnd\"].join(\" \");\n\nmodule.exports = PhotoView = (function(_super) {\n  __extends(PhotoView, _super);\n\n  function PhotoView() {\n    this.onClickListener = __bind(this.onClickListener, this);\n    this.events = __bind(this.events, this);\n    return PhotoView.__super__.constructor.apply(this, arguments);\n  }\n\n  PhotoView.prototype.template = require('templates/photo');\n\n  PhotoView.prototype.className = 'photo';\n\n  PhotoView.prototype.initialize = function(options) {\n    PhotoView.__super__.initialize.apply(this, arguments);\n    this.listenTo(this.model, 'progress', this.onProgress);\n    this.listenTo(this.model, 'thumbed', this.onThumbed);\n    this.listenTo(this.model, 'upError', this.onError);\n    this.listenTo(this.model, 'uploadComplete', this.onServer);\n    return this.listenTo(this.model, 'change', (function(_this) {\n      return function() {\n        return _this.render();\n      };\n    })(this));\n  };\n\n  PhotoView.prototype.events = function() {\n    return {\n      'click': 'onClickListener',\n      'click .delete': 'destroyModel'\n    };\n  };\n\n  PhotoView.prototype.getRenderData = function() {\n    return this.model.attributes;\n  };\n\n  PhotoView.prototype.afterRender = function() {\n    this.link = this.$('a');\n    this.image = this.$('img');\n    this.progressbar = this.$('.progressfill');\n    helpers.rotate(this.model.get('orientation'), this.image);\n    if (!this.model.isNew()) {\n      return this.link.addClass('server');\n    }\n  };\n\n  PhotoView.prototype.setProgress = function(percent) {\n    return this.progressbar.css('height', percent + '%');\n  };\n\n  PhotoView.prototype.onProgress = function(event) {\n    return this.setProgress(10 + 90 * event.loaded / event.total);\n  };\n\n  PhotoView.prototype.onThumbed = function() {\n    this.setProgress(10);\n    this.image.attr('src', this.model.thumb_du);\n    this.image.attr('orientation', this.model.get('orientation'));\n    return this.image.addClass('thumbed');\n  };\n\n  PhotoView.prototype.onServer = function() {\n    var col;\n    col = this.model.collection;\n    col.remove(this.model);\n    return col.add(this.model);\n  };\n\n  PhotoView.prototype.onError = function(err) {\n    this.setProgress(0);\n    this.error = this.model.get('title') + \" \" + err;\n    this.link.attr('title', this.error);\n    return this.image.attr('src', 'img/error.gif');\n  };\n\n  PhotoView.prototype.onClickListener = function(evt) {\n    if (this.model.isNew()) {\n      if (this.error) {\n        alert(this.error);\n      }\n      evt.stopPropagation();\n      evt.preventDefault();\n      return false;\n    }\n  };\n\n  PhotoView.prototype.destroyModel = function() {\n    this.$('.delete').spin();\n    return this.model.destroy();\n  };\n\n  return PhotoView;\n\n})(BaseView);\n"]}